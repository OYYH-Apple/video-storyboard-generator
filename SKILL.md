---
name: video-storyboard-generator
description: 视频分镜脚本生成器，支持头脑风暴、用户偏好记忆、15秒镜头规则、角色提示词生成、音效/BGM建议。用于生成带运镜指导、画面设计、旁白、角色描述的完整分镜脚本。支持极简版（内容描述）和专业版（详细运镜）。适用：教程、书籍介绍、评论、剧情、产品介绍、数据报告。当用户说"做分镜"、"分镜脚本"、"视频分镜"时使用。
---

# Video Storyboard Generator

通过头脑风暴与用户共同确定视频需求，基于用户画像提供个性化建议，生成结构化的视频分镜脚本。

## 核心原则

**段落是主题驱动的，不是标准化的**：分镜的段落结构完全取决于视频主题和内容需求。

**需求需要共同探索**：用户可能对视频的具体表现形式不够清晰，需要通过头脑风暴一起确定。

**用户画像驱动个性化**：系统会记忆用户的偏好，在后续交互中提供更贴合用户喜好的建议。

**镜头时长规则**：默认单个镜头时长不得超过15秒（可自定义）。

**内容安全规范**：所有分镜内容必须符合安全标准，不包含暴力、血腥或不适描述。详见 `references/content-safety.md`。

## 工作流程

### 阶段0：加载用户画像

在开始任何交互前，检查 `~/.video-storyboard/user-profile.md`。

如果画像文件存在，读取并应用用户的偏好设置。如果不存在，使用默认设置，并在本次交互结束后保存用户的选择偏好。

详见 `references/user-profile.md`。

---

### 阶段1：视频类型识别与头脑风暴

#### 识别视频类型

根据用户描述识别视频类型，详见 `references/video-types.md`。

#### 头脑风暴 - 需求澄清

根据视频类型进行针对性的头脑风暴，详见 `references/questions-by-type.md`。

**所有视频类型都需要确认：**
5. **镜头时长限制** - 单个镜头最长时长（默认15秒，可自定义）
   - 15秒以下：保持紧凑节奏
   - 15-20秒：适合需要更多信息密度的场景
   - 20秒以上：仅在特殊叙事需求时使用

6. **分镜版式** - 需要极简版（仅内容描述）还是专业版（详细运镜指导）？
   - **极简版**：仅列出每个分镜的画面内容和旁白
   - **专业版**：包含运镜、布局、视觉元素、过渡等详细信息

7. **音效/BGM** - 需要音效和BGM建议吗？
   - 音效：环境音、转场音效、强调音效
   - BGM：背景音乐类型和节奏

8. **旁白/台词呈现方式** - 如何展示旁白和角色台词？
    - 仅旁白：只有解说旁白
    - 仅台词：只有角色对话
    - 旁白+台词：两者都有，确保内容一致
    - 合并展示：旁白和台词合并为单一文本块
    - **重要：每个镜头必须有对应的旁白/台词，放在该镜头后面。如果某个镜头没有，标注"无"**

9. **OpenCode提示词** - 需要生成可在OpenCode中使用的执行提示词吗？（仅专业版）
   - 是：生成可直接复制到OpenCode的技术实现提示词
   - 否：跳过，仅输出分镜文档

**故事类、剧情类、电影类视频额外确认：**
10. **角色设定** - 主要角色有哪些？
    - 角色数量和定位
    - 角色外貌特征
    - 角色性格特点
    - 是否需要角色提示词（用于AI生成角色形象）

11. **角色提示词比例** - AI生图比例（默认9:16）
    - 9:16（纵向，适合短视频）
    - 16:9（横向，适合长视频）
    - 1:1（方形）
    - 21:9（电影宽屏）
    - 自定义比例

详见 `references/character-prompts.md`。

8. **场景设定** - 主要场景有哪些？
   - 室内/室外
   - 时间（白天/黑夜/傍晚）
   - 氛围/情绪

#### 视觉风格选择

根据视频类型和用户画像推荐风格，详见 `references/visual-styles.md`。优先推荐用户画像中记录的偏好风格。

---

### 阶段2：段落结构设计

根据视频类型和头脑风暴结果，设计段落结构。详见 `references/story-patterns.md`。

**设计原则：**
- 段落数量根据时长和内容复杂度决定（通常3-10个段落）
- 每个段落服务于一个清晰的叙事目标
- 段落间有逻辑递进关系

---

### 阶段3：镜头拆分（时长规则）

**核心规则：单个镜头时长不得超过用户设定的上限（默认15秒）**

超过上限的镜头必须拆分为多个子镜头，确保视觉节奏紧凑、镜头间有明确的运镜变化。

拆分策略详见 `references/shot-duration.md`。

---

### 阶段4：生成分镜脚本

基于确定的段落结构和镜头拆分结果，生成完整的分镜脚本。

#### 确定输出版式

根据用户选择，生成分镜脚本：

**极简版输出**：
- 每个镜头仅包含画面内容描述和时间
- 旁白内容（或台词内容）
- 简洁易读，快速规划
- **镜头内容使用text代码块格式**，方便复制

**专业版输出**：
- 详细的运镜描述
- 画面布局规范
- 视觉元素说明
- 过渡效果
- 时间区间
- 旁白内容（或台词内容）
- **镜头内容使用text代码块格式**，方便复制

#### 总体规格
- 视频标题和版本信息
- 总时长（秒数 + 帧数）
- 背景风格描述
- 视觉风格定义
- 旁白风格说明
- 主角/吉祥物设定

#### 角色提示词生成（故事/剧情/电影类）

如果视频类型是剧情类、故事类、电影类，为每个主要角色生成AI绘画提示词：

**内容安全要求**：
- 角色提示词中禁止包含暴力、血腥、恐怖或令人不适的描述
- 禁止使用描述临时状态的词语（如"微笑""哭泣""愤怒""奔跑"等）
- 使用描述性外貌特征替代状态词（如"嘴角自然弧度"替代"微笑"）
- 如需表现动作，使用姿势描述（如"单脚离地，身体前倾"替代"奔跑"）
- 涉及冲突或紧张场景时，使用抽象视觉元素替代直接描述（详见 `references/content-safety.md`）

**角色提示词包含：**
- 主体描述（外貌、衣着、年龄、性别）
- 面部特征（轮廓、五官形状，避免状态词如"微笑""严肃"）
- 风格描述（艺术风格、渲染风格、光线）
- 数量和权重标签
- 比例参数（默认9:16，可自定义）
- 修饰符标签
- 示例：
  ```
  主角1: 年轻女性，短发，白色衬衫，面部轮廓清晰，电影风格，电影光效，8k，高质量 --ar 9:16
  主角2: 中年男性，西装，面部线条分明，写实风格，电影光效，4k，细节丰富 --ar 9:16
  ```

**重要**：角色提示词中禁止使用描述临时状态的词语（如"微笑""惊讶""奔跑"），应使用描述外貌特征和姿势的词语。

详见 `references/character-prompts.md`。

#### 音效/BGM建议

如果用户需要音效/BGM建议，为每个镜头或段落提供：

**音效：**
- 环境音（雨声、风声、城市噪音等）
- 转场音效（ swoosh、glitch、fade等）
- 强调音效（点击、弹跳、whoosh等）

**BGM：**
- 音乐类型（电子、古典、流行、氛围等）
- 节奏和情绪（紧张、轻松、激昂、温馨）
- 音量建议（铺垫、高潮、结尾）

详见 `references/audio-bgm.md`。

#### 分镜段落
每个段落包含：
1. **段落目标** - 该段落要传达什么信息
2. **时间区间** - 开始和结束时间（秒）
3. **镜头序列** - 段落内的多个镜头（每个不超过用户设定的上限）
   - 每个镜头包含：运镜、布局、视觉、过渡、音效/BGM、旁白/台词
   - **旁白和台词必须放在每个镜头后面**，方便对应查看
4. **音效/BGM**（如启用）- 配套音效和BGM建议

**极简版镜头内容（必须使用text代码块格式）：**
```
画面描述：简洁说明镜头要展示什么
时间：镜头时长
旁白/台词：对应该镜头的解说词或角色台词（如果没有则标注"无"）
```

**专业版镜头内容（必须使用text代码块格式）：**
```
运镜描述：速度、方向、缓动函数
画面布局：元素位置、占比
视觉元素：具体元素描述
过渡方式：镜头间过渡效果
时间：镜头时长
音效（如启用）：具体音效类型
BGM（如启用）：音乐类型和音量
旁白/台词：对应该镜头的解说词或角色台词（如果没有则标注"无"）
```

旁白和台词一致性：
- 如果分镜中包含角色台词和旁白，确保两者内容一致，避免冲突
- 旁白用于解说和引导，台词用于角色对话，两者应相辅相成
- 在文本中明确标注旁白和台词的来源
- 每个镜头必须有对应的旁白/台词，如果没有则标注"无"

#### OpenCode 执行提示词（可选）

如果用户选择生成，创建可在 OpenCode 中直接使用的提示词，用于执行视频制作（仅专业版生成）。

---

### 阶段5：文件保存

在生成分镜文档前，确认文件保存位置。

**默认位置：** 用户当前项目的 `/docs` 文件夹

---
### 阶段6：更新用户画像

分镜生成完成后，更新用户画像文件。记录本次交互中用户的选择偏好，详见 `references/user-profile.md`。

## 运镜类型参考

常用运镜类型，详见 `references/camera-movements.md`。

- **推近 (Dolly In)** - 强调主体，适合开场和重点
- **拉远 (Dolly Out)** - 展示全景，适合过渡和总结
- **环绕 (Orbiting)** - 360度展示，适合3D结构
- **跟拍 (Tracking)** - 跟随运动，适合流程展示
- **摇移 (Pan)** - 水平移动，适合宽画面展示
- **特写 (Close-up)** - 强调细节，适合数据展示

## 参考资产

- `assets/storyboard-template.md` - 分镜模板文件
- `references/video-types.md` - 7类视频类型对照表
- `references/questions-by-type.md` - 按视频类型的提问清单
- `references/visual-styles.md` - 视觉风格参考
- `references/shot-duration.md` - 镜头时长和拆分规则
- `references/camera-movements.md` - 运镜类型参考
- `references/story-patterns.md` - 12种叙事模式
- `references/character-prompts.md` - 角色提示词生成指南（含无状态词规范）
- `references/audio-bgm.md` - 音效和BGM建议指南
- `references/user-profile.md` - 用户画像机制
- `references/output-templates.md` - 输出格式模板（含极简版和专业版）
- `references/content-safety.md` - 内容安全规范（暴力血腥替换方案）

## 最佳实践

### 头脑风暴阶段
- 提供选择而非开放式问题
- 根据主题特点给出建议
- 优先推荐用户画像中记录的偏好

### 段落设计阶段
- 开场前3秒必须抓住注意力
- 每个段落时长控制在8-30秒
- 保持段落间的视觉和叙事连贯性

### 镜头拆分阶段
- **严格遵守用户设定的时长上限**
- 拆分后相邻镜头要有运镜变化
- 避免连续相同类型的运镜

### 画面顺序设计
- **开场段落**（2-3个镜头）：快速切入 → 主体展示 → 细节特写
- **核心段落**（2-4个镜头）：环绕展示 → 跟随流程 → 特写强调
- **结尾段落**（2个镜头）：汇聚元素 → 拉远全景
- **单个镜头时长**：3-15秒（不得超过用户设定的上限）

### 脚本生成阶段
- 运镜描述要具体（速度、方向、缓动函数）
- 画面布局强调紧凑（80-90%占屏）
- 旁白与视觉同步
- 如有台词，确保旁白和台词内容一致
- 在输出中明确标注旁白和台词的来源
- **每个镜头必须包含对应的旁白/台词**，放在该镜头的最后
- 如果某个镜头没有旁白/台词，标注"无"
- 每个镜头的旁白/台词应该与该镜头的画面内容对应
- **每个镜头内容必须使用text代码块格式**，方便用户复制到其他应用
- 技术提示词包含所有视觉规范
- **内容安全检查**：确保没有暴力、血腥或不适描述，使用抽象化表达和视觉隐喻替代

## 输出格式

生成的分镜脚本包含：
1. **结构化的分镜文档 (.md)** - 便于人类阅读和参考
   - **每个镜头内容必须使用text代码块格式**（包括极简版和专业版）
   - text格式示例：\`\`\`画面描述...时间...旁白...\`\`\`
   - 方便用户直接复制镜头内容到其他应用
   - 旁白和台词明确标注，确保一致性
   - 每个镜头后面紧跟该镜头的旁白/台词，方便对应
2. **OpenCode 执行提示词（可选）** - 可直接用于执行视频制作
3. **保存位置确认** - 确保文档妥善保存

详见 `references/output-templates.md`。
